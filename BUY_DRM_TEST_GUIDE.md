# 🧪 Buy DRM 测试指南

## 📋 测试准备

### 1. 测试环境
- **网络**: BSC Testnet (Chain ID: 97)
- **预览地址**: http://localhost:8888/buy-drm-preview.html
- **钱包**: MetaMask 或 OKX Wallet

### 2. 测试钱包

#### 测试钱包 1（推荐用于大额测试）
```
地址: 0x0Bf9D375e79117e114f640F03A11fA8E68F6a940
私钥: 0x6648f1dc282396650c3fbe253c1e0098c86f16aa76dae2514d435903a1218967

当前余额:
- BNB: 0.0998930194 tBNB
- USDT: 40,012 USDT
- DRM: 49,940 DRM
```

#### 测试钱包 2（推荐用于新购买测试）
```
地址: 0x541E966356Bb5EBfB4142f58426926274ad0E85B
私钥: 0x0eb7542cf331bc9ed41d3d0b7a0266aa17fbc4eb11722548827345c9ea3f19c0

当前余额:
- BNB: 0.0999649106 tBNB
- USDT: 49,500 USDT
- DRM: 2,500 DRM
```

---

## 🔧 测试步骤

### 步骤 1: 导入测试钱包

#### 使用 MetaMask
1. 打开 MetaMask 扩展
2. 点击右上角账户图标
3. 选择 "导入账户"
4. 粘贴私钥（上面任选一个）
5. 点击 "导入"

#### 使用 OKX Wallet
1. 打开 OKX Wallet
2. 点击 "我的" → "管理钱包"
3. 选择 "导入钱包"
4. 选择 "私钥导入"
5. 粘贴私钥
6. 设置钱包名称（如 "DRM Test 1"）
7. 点击 "导入"

---

### 步骤 2: 切换到 BSC Testnet

#### 自动切换（推荐）
1. 打开预览页面
2. 点击 "Connect Wallet"
3. 如果不在 BSC Testnet，会自动提示切换
4. 点击 "确认" 切换网络

#### 手动切换
1. 打开钱包
2. 点击网络选择器
3. 选择 "BSC Testnet"
4. 如果没有，点击 "添加网络"
5. 输入以下信息：
   ```
   网络名称: BSC Testnet
   RPC URL: https://data-seed-prebsc-1-s1.binance.org:8545/
   Chain ID: 97
   符号: tBNB
   区块浏览器: https://testnet.bscscan.com/
   ```

---

### 步骤 3: 添加代币到钱包

#### 添加 DRM Token
```
合约地址: 0x1C8c3e823F98EFEc34FEf5673b4d63a23A251224
符号: DRM
小数位: 18
```

#### 添加 Test USDT
```
合约地址: 0x86d075bA497457C624Fe2003E7704C2Bd3F864d8
符号: USDT
小数位: 18
```

**操作步骤**:
1. 打开钱包
2. 点击 "导入代币" 或 "添加代币"
3. 选择 "自定义代币"
4. 粘贴合约地址
5. 符号和小数位会自动填充
6. 点击 "添加"

---

### 步骤 4: 连接钱包到界面

1. 打开预览页面: http://localhost:8888/buy-drm-preview.html
2. 点击 "👛 Connect Wallet" 按钮
3. 选择你的钱包（MetaMask 或 OKX）
4. 在钱包弹窗中点击 "连接"
5. 如果需要，确认切换到 BSC Testnet
6. 连接成功后，会显示你的地址（如 0x0Bf9...a940）

---

## 🧪 测试场景

### 场景 1: 快捷购买 - 小额测试（100 USDT）

**目标**: 测试快捷购买按钮和基本购买流程

**步骤**:
1. 连接钱包（使用测试钱包 1 或 2）
2. 点击 "100 USDT → 200 DRM" 按钮
3. 等待钱包弹出授权请求
4. 点击 "确认" 授权 USDT
5. 等待授权交易确认（约 3-5 秒）
6. 钱包会再次弹出购买交易请求
7. 点击 "确认" 购买
8. 等待购买交易确认（约 3-5 秒）
9. 查看成功提示

**预期结果**:
- ✅ 授权成功
- ✅ 购买成功
- ✅ 收到 200 DRM
- ✅ 扣除 100 USDT
- ✅ 购买历史中显示新记录

---

### 场景 2: 自定义金额购买（1,000 USDT）

**目标**: 测试自定义金额输入和计算

**步骤**:
1. 连接钱包
2. 在 "Custom Amount" 区域输入 `1000`
3. 查看计算结果（应显示 2,000 DRM）
4. 点击 "💎 Buy Now" 按钮
5. 确认授权（如果需要）
6. 确认购买
7. 等待交易确认

**预期结果**:
- ✅ 实时计算正确（1000 USDT = 2000 DRM）
- ✅ 购买成功
- ✅ 收到 2,000 DRM
- ✅ 扣除 1,000 USDT

---

### 场景 3: 最大额购买（10,000 USDT）

**目标**: 测试最大购买限制

**步骤**:
1. 连接钱包（使用测试钱包 2，余额充足）
2. 点击 "🔥 MAX 10,000 USDT → 20,000 DRM" 按钮
3. 确认授权（如果需要）
4. 确认购买
5. 等待交易确认

**预期结果**:
- ✅ 购买成功
- ✅ 收到 20,000 DRM
- ✅ 扣除 10,000 USDT
- ✅ 这是单次最大购买额

---

### 场景 4: 边界测试 - 最小金额

**目标**: 测试最小购买限制（10 USDT）

**步骤**:
1. 在自定义金额输入 `10`
2. 查看计算结果（应显示 20 DRM）
3. 点击购买
4. 确认交易

**预期结果**:
- ✅ 允许购买
- ✅ 收到 20 DRM

---

### 场景 5: 边界测试 - 低于最小金额

**目标**: 测试输入验证

**步骤**:
1. 在自定义金额输入 `5`
2. 点击购买

**预期结果**:
- ❌ 显示错误提示："Please enter amount between 10 and 10,000 USDT"
- ❌ 不允许购买

---

### 场景 6: 边界测试 - 超过最大金额

**目标**: 测试最大限制

**步骤**:
1. 在自定义金额输入 `15000`
2. 点击购买

**预期结果**:
- ❌ 显示错误提示："Please enter amount between 10 and 10,000 USDT"
- ❌ 不允许购买

---

### 场景 7: 查看购买历史

**目标**: 测试购买历史显示

**步骤**:
1. 完成至少一次购买
2. 滚动到 "Your Purchase History" 区域
3. 查看购买记录

**预期结果**:
- ✅ 显示所有购买记录
- ✅ 每条记录包含：
  - 购买编号
  - 时间戳
  - 支付的 USDT
  - 收到的 DRM

---

### 场景 8: 余额不足测试

**目标**: 测试余额不足的错误处理

**步骤**:
1. 使用余额较少的钱包
2. 尝试购买超过余额的金额

**预期结果**:
- ❌ 显示错误："Insufficient USDT balance"
- ❌ 交易不会发送

---

### 场景 9: 未连接钱包测试

**目标**: 测试未连接钱包的提示

**步骤**:
1. 断开钱包连接（点击 Disconnect）
2. 尝试点击购买按钮

**预期结果**:
- ❌ 显示提示："Please connect your wallet first"
- ❌ 不允许购买

---

### 场景 10: 网络切换测试

**目标**: 测试错误网络的处理

**步骤**:
1. 连接钱包
2. 在钱包中切换到其他网络（如 Ethereum Mainnet）
3. 尝试购买

**预期结果**:
- ❌ 显示错误："Please switch to BSC Testnet"
- ❌ 不允许购买

---

## 📊 测试检查清单

### 功能测试
- [ ] 连接 MetaMask 钱包
- [ ] 连接 OKX 钱包
- [ ] 自动切换到 BSC Testnet
- [ ] 显示钱包地址
- [ ] 断开钱包连接
- [ ] 快捷购买（100 USDT）
- [ ] 快捷购买（500 USDT）
- [ ] 快捷购买（1,000 USDT）
- [ ] 快捷购买（5,000 USDT）
- [ ] 快捷购买（10,000 USDT）
- [ ] 自定义金额购买
- [ ] 实时计算 DRM 数量
- [ ] USDT 授权流程
- [ ] 购买交易确认
- [ ] 查看购买历史
- [ ] 刷新数据显示

### 边界测试
- [ ] 最小金额（10 USDT）
- [ ] 最大金额（10,000 USDT）
- [ ] 低于最小金额（应拒绝）
- [ ] 超过最大金额（应拒绝）
- [ ] 余额不足（应拒绝）

### 错误处理
- [ ] 未连接钱包
- [ ] 错误的网络
- [ ] 授权失败
- [ ] 购买失败
- [ ] 用户取消交易

### UI/UX 测试
- [ ] 按钮悬停效果
- [ ] 输入框聚焦效果
- [ ] 加载动画
- [ ] 成功提示
- [ ] 错误提示
- [ ] 响应式布局（手机）
- [ ] 响应式布局（平板）

---

## 🐛 常见问题

### Q1: 无法连接钱包
**A**: 
1. 确保已安装 MetaMask 或 OKX Wallet
2. 刷新页面重试
3. 检查钱包是否已解锁

### Q2: 授权失败
**A**:
1. 确保有足够的 BNB 支付 gas 费
2. 检查网络是否为 BSC Testnet
3. 重试授权

### Q3: 购买失败
**A**:
1. 确保已完成 USDT 授权
2. 确保 USDT 余额充足
3. 确保有足够的 BNB 支付 gas 费
4. 检查购买金额是否在 10-10,000 USDT 范围内

### Q4: 看不到购买历史
**A**:
1. 确保钱包已连接
2. 刷新页面
3. 检查是否有购买记录

### Q5: 价格显示不正确
**A**:
1. 刷新页面
2. 检查网络连接
3. 查看浏览器控制台是否有错误

---

## 📝 测试报告模板

```
测试日期: ____________________
测试人员: ____________________
测试钱包: ____________________

测试结果:
[ ] 场景 1: 快捷购买 - 小额测试
[ ] 场景 2: 自定义金额购买
[ ] 场景 3: 最大额购买
[ ] 场景 4: 最小金额测试
[ ] 场景 5: 低于最小金额测试
[ ] 场景 6: 超过最大金额测试
[ ] 场景 7: 查看购买历史
[ ] 场景 8: 余额不足测试
[ ] 场景 9: 未连接钱包测试
[ ] 场景 10: 网络切换测试

发现的问题:
1. ____________________
2. ____________________
3. ____________________

建议改进:
1. ____________________
2. ____________________
3. ____________________
```

---

## 🎉 测试完成

完成所有测试后，你应该能够：
- ✅ 成功连接钱包
- ✅ 使用快捷按钮购买 DRM
- ✅ 使用自定义金额购买 DRM
- ✅ 查看购买历史
- ✅ 理解所有错误提示

**准备好开始测试了吗？** 🚀

